<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=375px, initial-scale=1.0">
  <title>추천 숙소 목록 - ThankQ Camping</title>
  <script src="https://cdn.tailwindcss.com/3.4.16"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css" rel="stylesheet">
  <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=7c64a249ef8e3b9b648f20a50c07b249"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#FF7A45',
            secondary: '#4A90E2'
          },
          borderRadius: {
            'none': '0px',
            'sm': '4px',
            DEFAULT: '8px',
            'md': '12px',
            'lg': '16px',
            'xl': '20px',
            '2xl': '24px',
            '3xl': '32px',
            'full': '9999px',
            'button': '8px'
          }
        }
      }
    }
  </script>
  <style>
    :where([class^="ri-"])::before {
      content: "\f3c2";
    }

    .filter-dropdown {
      transform: translateY(-10px);
      opacity: 0;
      transition: all 0.3s ease;
    }

    .filter-dropdown.show {
      transform: translateY(0);
      opacity: 1;
    }

    .accommodation-card {
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .accommodation-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    }

    .map-view {
      transition: all 0.3s ease;
    }

    .heart-animation {
      animation: heartPulse 0.3s ease;
    }

    @keyframes heartPulse {
      0% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.2);
      }

      100% {
        transform: scale(1);
      }
    }

    .sort-dropdown {
      display: none;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }

    .sort-dropdown.show {
      display: block;
      max-height: 200px;
    }

    /* 위시리스트 버튼 애니메이션 */
    .wishlist-btn {
      transition: all 0.3s ease;
    }

    .wishlist-btn:hover {
      transform: scale(1.1);
    }

    .wishlist-btn.active {
      color: #ef4444 !important;
      transform: scale(1.2);
    }

    .wishlist-btn i {
      transition: all 0.2s ease;
    }

    /* 스크롤바 숨김 */
    ::-webkit-scrollbar {
      display: none;
    }

    * {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }

    /* 지도 뷰 토글 스타일 */
    #listView,
    #mapView {
      position: absolute;
      top: 200px;
      /* 헤더 + 필터 영역 + AI 분석 결과 영역 + 간격 */
      left: 0;
      right: 0;
      height: calc(100vh - 253px);
      /* 화면 사이즈에서 253px를 뺀 크기 */
      transition: opacity 0.3s ease;
    }

    /* 처음엔 리스트만 보이도록 */
    #listView {
      opacity: 1;
      z-index: 20;
      pointer-events: auto;
      overflow-y: auto;
      /* 리스트 뷰는 스크롤 허용 */
    }

    #mapView {
      opacity: 0;
      z-index: 10;
      pointer-events: none;
      overflow: hidden;
      /* 지도 뷰는 스크롤 방지 */
    }

    #mapView.show {
      opacity: 1;
      z-index: 20;
      pointer-events: auto;
      overflow: hidden;
      /* 지도 뷰는 스크롤 방지 */
    }

    /* 지도 알림 애니메이션 */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-fadeIn {
      animation: fadeIn 0.5s ease-out forwards;
    }
  </style>
</head>

<body class="  min-h-[762px] mx-auto bg-gray-50">
  <header class="fixed top-0 left-0 right-0 z-50 bg-white">
    <div class="flex items-center justify-between px-4 py-3">
      <a href="#" onclick="event.preventDefault(); history.back();" data-readdy="true"
        class="w-8 h-8 flex items-center justify-center cursor-pointer">
        <i class="ri-arrow-left-line text-xl"></i>
      </a>
      <h1 class="text-lg font-medium absolute left-1/2 transform -translate-x-1/2">추천 숙소</h1>
      <div class="w-8 h-8"></div>
    </div>
  </header>
  <main class="pt-16 pb-14 relative min-h-screen">
    <div class="px-4 py-4 bg-white border-b h-[137px]">
      <div class="flex items-center justify-between mb-3">
        <div class="flex items-center gap-2">
          <button class="px-3 py-2 bg-gray-100 rounded-lg flex items-center gap-2 cursor-pointer" id="filterBtn">
            <i class="ri-filter-3-line text-sm"></i>
            <span class="text-sm font-medium">필터</span>
          </button>
          <div class="relative">
            <button class="px-3 py-2 bg-gray-100 rounded-lg flex items-center gap-2 cursor-pointer" id="sortBtn">
              <span class="text-sm font-medium" id="sortText">추천순</span>
              <i class="ri-arrow-down-s-line text-sm"></i>
            </button>
            <div class="absolute top-full left-0 mt-1 bg-white rounded-lg shadow-lg border sort-dropdown z-[60]"
              id="sortDropdown">
              <button class="w-full px-4 py-2 text-left text-sm hover:bg-gray-50 cursor-pointer"
                data-sort="recommended">추천순</button>
              <button class="w-full px-4 py-2 text-left text-sm hover:bg-gray-50 cursor-pointer"
                data-sort="price">가격순</button>
              <button class="w-full px-4 py-2 text-left text-sm hover:bg-gray-50 cursor-pointer"
                data-sort="rating">평점순</button>
              <button class="w-full px-4 py-2 text-left text-sm hover:bg-gray-50 cursor-pointer"
                data-sort="distance">거리순</button>
            </div>
          </div>
        </div>
        <div class="flex items-center gap-2">
          <button
            class="px-3 py-2 bg-primary text-white rounded-lg flex items-center gap-2 cursor-pointer !rounded-button"
            id="listViewBtn">
            <i class="ri-list-check text-sm"></i>
            <span class="text-sm font-medium">목록</span>
          </button>
          <button class="px-3 py-2 bg-gray-100 rounded-lg flex items-center gap-2 cursor-pointer !rounded-button"
            id="mapViewBtn">
            <i class="ri-map-2-line text-sm"></i>
            <span class="text-sm font-medium">지도</span>
          </button>
        </div>
      </div>
      <div class="px-4 py-2 bg-primary/5">
        <p class="text-sm text-gray-700">
          <span class="font-medium text-primary">AI 분석 결과:</span> 2인, 글램핑, 15만원 예산으로 <span
            class="font-medium">24개</span> 숙소를 찾았어요
        </p>
      </div>
    </div>
    <div id="listView" class="px-4 py-4 space-y-4">
      <div class="accommodation-card bg-white rounded-xl overflow-hidden shadow-sm cursor-pointer block">
        <div class="relative">
          <img
            src="https://readdy.ai/api/search-image?query=Luxury%20glamping%20tent%20with%20panoramic%20windows%20surrounded%20by%20forest%2C%20premium%20camping%20experience%2C%20cozy%20interior%20lighting%2C%20evening%20atmosphere%2C%20professional%20photography%2C%20high-quality%20resort%20accommodation&width=375&height=200&seq=101&orientation=landscape"
            class="w-full h-48 object-cover object-top" alt="가평 프리미엄 글램핑">
          <button
            class="absolute top-3 right-3 w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-sm wishlist-btn">
            <i class="ri-heart-line text-lg text-gray-600"></i>
          </button>
          <div class="absolute bottom-3 left-3 bg-primary text-white px-2 py-1 rounded text-xs font-medium">
            AI 추천
          </div>
        </div>
        <div class="p-4">
          <div class="flex justify-between items-start mb-2">
            <h3 class="font-medium text-lg">가평 프리미엄 글램핑</h3>
            <div class="flex items-center gap-1">
              <i class="ri-star-fill text-yellow-400 text-sm"></i>
              <span class="text-sm font-medium">4.8</span>
            </div>
          </div>
          <p class="text-sm text-gray-600 mb-3">자연 속 럭셔리 글램핑 체험 • 반려동물 동반 가능</p>
          <div class="flex items-center gap-4 text-xs text-gray-500 mb-3">
            <div class="flex items-center gap-1">
              <i class="ri-map-pin-line"></i>
              <span>경기도 가평군 청평면 대성리</span>
            </div>
            <div class="flex items-center gap-1">
              <i class="ri-car-line"></i>
              <span>차량 1시간</span>
            </div>
          </div>
          <div class="flex items-center gap-2 mb-3">
            <span class="px-2 py-1 bg-blue-50 text-blue-600 rounded text-xs">수영장</span>
            <span class="px-2 py-1 bg-green-50 text-green-600 rounded text-xs">바베큐장</span>
            <span class="px-2 py-1 bg-purple-50 text-purple-600 rounded text-xs">와이파이</span>
          </div>
          <div class="flex items-center justify-between">
            <div>
              <span class="text-lg font-bold text-primary">180,000원</span>
              <span class="text-sm text-gray-500">/ 박</span>
            </div>
            <a href="#"
              class="px-4 py-2 bg-primary text-white rounded-lg text-sm font-medium cursor-pointer !rounded-button reservation-btn"
              data-title="가평 프리미엄 글램핑" data-region="경기도 가평군 청평면 대성리" data-price="180000" data-rating="4.8"
              data-description="자연 속 럭셔리 글램핑 체험 • 반려동물 동반 가능" data-distance="차량 1시간" data-facilities="수영장,바베큐장,와이파이"
              data-image="https://readdy.ai/api/search-image?query=Luxury%20glamping%20tent%20with%20panoramic%20windows%20surrounded%20by%20forest%2C%20premium%20camping%20experience%2C%20cozy%20interior%20lighting%2C%20evening%20atmosphere%2C%20professional%20photography%2C%20high-quality%20resort%20accommodation&width=375&height=200&seq=101&orientation=landscape"
              data-badge="AI 추천">
              예약하기
            </a>
          </div>
        </div>
      </div>
      <div class="accommodation-card bg-white rounded-xl overflow-hidden shadow-sm cursor-pointer block">
        <div class="relative">
          <img
            src="https://readdy.ai/api/search-image?query=Modern%20glamping%20dome%20with%20mountain%20view%2C%20luxury%20outdoor%20accommodation%2C%20comfortable%20interior%20setup%2C%20sunset%20lighting%2C%20high-quality%20photography%2C%20romantic%20couple-friendly%20atmosphere&width=375&height=200&seq=102&orientation=landscape"
            class="w-full h-48 object-cover object-top" alt="양평 힐링 글램핑">
          <button
            class="absolute top-3 right-3 w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-sm wishlist-btn">
            <i class="ri-heart-line text-lg text-gray-600"></i>
          </button>
          <div class="absolute bottom-3 left-3 bg-secondary text-white px-2 py-1 rounded text-xs font-medium">
            인기
          </div>
        </div>
        <div class="p-4">
          <div class="flex justify-between items-start mb-2">
            <h3 class="font-medium text-lg">양평 힐링 글램핑</h3>
            <div class="flex items-center gap-1">
              <i class="ri-star-fill text-yellow-400 text-sm"></i>
              <span class="text-sm font-medium">4.6</span>
            </div>
          </div>
          <p class="text-sm text-gray-600 mb-3">계곡 옆 힐링 글램핑 • 커플 추천</p>
          <div class="flex items-center gap-4 text-xs text-gray-500 mb-3">
            <div class="flex items-center gap-1">
              <i class="ri-map-pin-line"></i>
              <span>경기도 양평군 양서면 용담리</span>
            </div>
            <div class="flex items-center gap-1">
              <i class="ri-car-line"></i>
              <span>차량 50분</span>
            </div>
          </div>
          <div class="flex items-center gap-2 mb-3">
            <span class="px-2 py-1 bg-green-50 text-green-600 rounded text-xs">바베큐장</span>
            <span class="px-2 py-1 bg-purple-50 text-purple-600 rounded text-xs">와이파이</span>
            <span class="px-2 py-1 bg-orange-50 text-orange-600 rounded text-xs">주차장</span>
          </div>
          <div class="flex items-center justify-between">
            <div>
              <span class="text-lg font-bold text-primary">150,000원</span>
              <span class="text-sm text-gray-500">/ 박</span>
            </div>
            <a href="#"
              class="px-4 py-2 bg-primary text-white rounded-lg text-sm font-medium cursor-pointer !rounded-button reservation-btn"
              data-title="양평 힐링 글램핑" data-region="경기도 양평군 양서면 용담리" data-price="150000" data-rating="4.6"
              data-description="계곡 옆 힐링 글램핑 • 커플 추천" data-distance="차량 50분" data-facilities="바베큐장,와이파이,주차장"
              data-image="https://readdy.ai/api/search-image?query=Modern%20glamping%20dome%20with%20mountain%20view%2C%20luxury%20outdoor%20accommodation%2C%20comfortable%20interior%20setup%2C%20sunset%20lighting%2C%20high-quality%20photography%2C%20romantic%20couple-friendly%20atmosphere&width=375&height=200&seq=102&orientation=landscape"
              data-badge="인기">
              예약하기
            </a>
          </div>
        </div>
      </div>
      <div class="accommodation-card bg-white rounded-xl overflow-hidden shadow-sm cursor-pointer block">
        <div class="relative">
          <img
            src="https://readdy.ai/api/search-image?query=Cozy%20glamping%20tent%20with%20private%20deck%2C%20forest%20setting%2C%20romantic%20atmosphere%2C%20warm%20interior%20lighting%2C%20couple-friendly%20accommodation%2C%20premium%20outdoor%20experience&width=375&height=200&seq=103&orientation=landscape"
            class="w-full h-48 object-cover object-top" alt="포천 숲속 글램핑">
          <button
            class="absolute top-3 right-3 w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-sm wishlist-btn">
            <i class="ri-heart-line text-lg text-gray-600"></i>
          </button>
        </div>
        <div class="p-4">
          <div class="flex justify-between items-start mb-2">
            <h3 class="font-medium text-lg">포천 숲속 글램핑</h3>
            <div class="flex items-center gap-1">
              <i class="ri-star-fill text-yellow-400 text-sm"></i>
              <span class="text-sm font-medium">4.7</span>
            </div>
          </div>
          <p class="text-sm text-gray-600 mb-3">숲속 프라이빗 글램핑 • 조용한 휴식</p>
          <div class="flex items-center gap-4 text-xs text-gray-500 mb-3">
            <div class="flex items-center gap-1">
              <i class="ri-map-pin-line"></i>
              <span>경기도 포천시 내촌면 금현리</span>
            </div>
            <div class="flex items-center gap-1">
              <i class="ri-car-line"></i>
              <span>차량 1시간 10분</span>
            </div>
          </div>
          <div class="flex items-center gap-2 mb-3">
            <span class="px-2 py-1 bg-green-50 text-green-600 rounded text-xs">바베큐장</span>
            <span class="px-2 py-1 bg-purple-50 text-purple-600 rounded text-xs">와이파이</span>
          </div>
          <div class="flex items-center justify-between">
            <div>
              <span class="text-lg font-bold text-primary">160,000원</span>
              <span class="text-sm text-gray-500">/ 박</span>
            </div>
            <a href="#"
              class="px-4 py-2 bg-primary text-white rounded-lg text-sm font-medium cursor-pointer !rounded-button reservation-btn"
              data-title="포천 숲속 글램핑" data-region="경기도 포천시 내촌면 금현리" data-price="160000" data-rating="4.7"
              data-description="숲속 프라이빗 글램핑 • 조용한 휴식" data-distance="차량 1시간 10분" data-facilities="바베큐장,와이파이"
              data-image="https://readdy.ai/api/search-image?query=Cozy%20glamping%20tent%20with%20private%20deck%2C%20forest%20setting%2C%20romantic%20atmosphere%2C%20warm%20interior%20lighting%2C%20couple-friendly%20accommodation%2C%20premium%20outdoor%20experience&width=375&height=200&seq=103&orientation=landscape"
              data-badge="">
              예약하기
            </a>
          </div>
        </div>
      </div>
      <div class="accommodation-card bg-white rounded-xl overflow-hidden shadow-sm cursor-pointer block">
        <div class="relative">
          <img
            src="https://readdy.ai/api/search-image?query=Luxury%20glamping%20village%20with%20multiple%20tents%2C%20family-friendly%20outdoor%20resort%2C%20beautiful%20landscape%20setting%2C%20professional%20hospitality%20photography%2C%20premium%20camping%20facilities&width=375&height=200&seq=104&orientation=landscape"
            class="w-full h-48 object-cover object-top" alt="용인 패밀리 글램핑">
          <button
            class="absolute top-3 right-3 w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-sm wishlist-btn">
            <i class="ri-heart-line text-lg text-gray-600"></i>
          </button>
        </div>
        <div class="p-4">
          <div class="flex justify-between items-start mb-2">
            <h3 class="font-medium text-lg">용인 패밀리 글램핑</h3>
            <div class="flex items-center gap-1">
              <i class="ri-star-fill text-yellow-400 text-sm"></i>
              <span class="text-sm font-medium">4.5</span>
            </div>
          </div>
          <p class="text-sm text-gray-600 mb-3">가족 단위 추천 글램핑 • 다양한 액티비티</p>
          <div class="flex items-center gap-4 text-xs text-gray-500 mb-3">
            <div class="flex items-center gap-1">
              <i class="ri-map-pin-line"></i>
              <span>경기도 용인시 처인구 모현면 능원리</span>
            </div>
            <div class="flex items-center gap-1">
              <i class="ri-car-line"></i>
              <span>차량 40분</span>
            </div>
          </div>
          <div class="flex items-center gap-2 mb-3">
            <span class="px-2 py-1 bg-blue-50 text-blue-600 rounded text-xs">수영장</span>
            <span class="px-2 py-1 bg-green-50 text-green-600 rounded text-xs">바베큐장</span>
            <span class="px-2 py-1 bg-orange-50 text-orange-600 rounded text-xs">주차장</span>
          </div>
          <div class="flex items-center justify-between">
            <div>
              <span class="text-lg font-bold text-primary">140,000원</span>
              <span class="text-sm text-gray-500">/ 박</span>
            </div>
            <a href="#"
              class="px-4 py-2 bg-primary text-white rounded-lg text-sm font-medium cursor-pointer !rounded-button reservation-btn"
              data-title="용인 패밀리 글램핑" data-region="경기도 용인시 처인구 모현면 능원리" data-price="140000" data-rating="4.5"
              data-description="가족 단위 추천 글램핑 • 다양한 액티비티" data-distance="차량 40분" data-facilities="수영장,바베큐장,주차장"
              data-image="https://readdy.ai/api/search-image?query=Luxury%20glamping%20village%20with%20multiple%20tents%2C%20family-friendly%20outdoor%20resort%2C%20beautiful%20landscape%20setting%2C%20professional%20hospitality%20photography%2C%20premium%20camping%20facilities&width=375&height=200&seq=104&orientation=landscape"
              data-badge="">
              예약하기
            </a>
          </div>
        </div>
      </div>
      <div class="accommodation-card bg-white rounded-xl overflow-hidden shadow-sm cursor-pointer block">
        <div class="relative">
          <img
            src="https://readdy.ai/api/search-image?query=Riverside%20glamping%20tents%20with%20water%20view%2C%20peaceful%20natural%20setting%2C%20luxury%20camping%20experience%2C%20serene%20atmosphere%2C%20high-quality%20outdoor%20accommodation%20photography&width=375&height=200&seq=105&orientation=landscape"
            class="w-full h-48 object-cover object-top" alt="남양주 리버사이드 글램핑">
          <button
            class="absolute top-3 right-3 w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-sm wishlist-btn">
            <i class="ri-heart-line text-lg text-gray-600"></i>
          </button>
        </div>
        <div class="p-4">
          <div class="flex justify-between items-start mb-2">
            <h3 class="font-medium text-lg">남양주 리버사이드 글램핑</h3>
            <div class="flex items-center gap-1">
              <i class="ri-star-fill text-yellow-400 text-sm"></i>
              <span class="text-sm font-medium">4.4</span>
            </div>
          </div>
          <p class="text-sm text-gray-600 mb-3">강변 뷰 글램핑 • 수상 액티비티 가능</p>
          <div class="flex items-center gap-4 text-xs text-gray-500 mb-3">
            <div class="flex items-center gap-1">
              <i class="ri-map-pin-line"></i>
              <span>경기도 남양주시 와부읍 도곡리</span>
            </div>
            <div class="flex items-center gap-1">
              <i class="ri-car-line"></i>
              <span>차량 45분</span>
            </div>
          </div>
          <div class="flex items-center gap-2 mb-3">
            <span class="px-2 py-1 bg-green-50 text-green-600 rounded text-xs">바베큐장</span>
            <span class="px-2 py-1 bg-purple-50 text-purple-600 rounded text-xs">와이파이</span>
          </div>
          <div class="flex items-center justify-between">
            <div>
              <span class="text-lg font-bold text-primary">135,000원</span>
              <span class="text-sm text-gray-500">/ 박</span>
            </div>
            <a href="#"
              class="px-4 py-2 bg-primary text-white rounded-lg text-sm font-medium cursor-pointer !rounded-button reservation-btn"
              data-title="남양주 리버사이드 글램핑" data-region="경기도 남양주시 와부읍 도곡리" data-price="135000" data-rating="4.4"
              data-description="강변 뷰 글램핑 • 수상 액티비티 가능" data-distance="차량 45분" data-facilities="바베큐장,와이파이"
              data-image="https://readdy.ai/api/search-image?query=Riverside%20glamping%20tents%20with%20water%20view%2C%20peaceful%20natural%20setting%2C%20luxury%20camping%20experience%2C%20serene%20atmosphere%2C%20high-quality%20outdoor%20accommodation%20photography&width=375&height=200&seq=105&orientation=landscape"
              data-badge="">
              예약하기
            </a>
          </div>
        </div>
      </div>
      <div class="accommodation-card bg-white rounded-xl overflow-hidden shadow-sm cursor-pointer block">
        <div class="relative">
          <img
            src="https://readdy.ai/api/search-image?query=Mountain%20view%20glamping%20resort%20with%20panoramic%20scenery%2C%20premium%20outdoor%20accommodation%2C%20luxury%20camping%20facilities%2C%20beautiful%20natural%20landscape%2C%20professional%20resort%20photography&width=375&height=200&seq=106&orientation=landscape"
            class="w-full h-48 object-cover object-top" alt="이천 마운틴뷰 글램핑">
          <button
            class="absolute top-3 right-3 w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-sm wishlist-btn">
            <i class="ri-heart-line text-lg text-gray-600"></i>
          </button>
        </div>
        <div class="p-4">
          <div class="flex justify-between items-start mb-2">
            <h3 class="font-medium text-lg">이천 마운틴뷰 글램핑</h3>
            <div class="flex items-center gap-1">
              <i class="ri-star-fill text-yellow-400 text-sm"></i>
              <span class="text-sm font-medium">4.6</span>
            </div>
          </div>
          <p class="text-sm text-gray-600 mb-3">산 전망 글램핑 • 일출 명소</p>
          <div class="flex items-center gap-4 text-xs text-gray-500 mb-3">
            <div class="flex items-center gap-1">
              <i class="ri-map-pin-line"></i>
              <span>경기도 이천시 마장면 목리</span>
            </div>
            <div class="flex items-center gap-1">
              <i class="ri-car-line"></i>
              <span>차량 1시간 20분</span>
            </div>
          </div>
          <div class="flex items-center gap-2 mb-3">
            <span class="px-2 py-1 bg-green-50 text-green-600 rounded text-xs">바베큐장</span>
            <span class="px-2 py-1 bg-orange-50 text-orange-600 rounded text-xs">주차장</span>
          </div>
          <div class="flex items-center justify-between">
            <div>
              <span class="text-lg font-bold text-primary">170,000원</span>
              <span class="text-sm text-gray-500">/ 박</span>
            </div>
            <a href="#"
              class="px-4 py-2 bg-primary text-white rounded-lg text-sm font-medium cursor-pointer !rounded-button reservation-btn"
              data-title="이천 마운틴뷰 글램핑" data-region="경기도 이천시 마장면 목리" data-price="170000" data-rating="4.6"
              data-description="산 전망 글램핑 • 일출 명소" data-distance="차량 1시간 20분" data-facilities="바베큐장,주차장"
              data-image="https://readdy.ai/api/search-image?query=Mountain%20view%20glamping%20resort%20with%20panoramic%20scenery%2C%20premium%20outdoor%20accommodation%2C%20luxury%20camping%20facilities%2C%20beautiful%20natural%20landscape%2C%20professional%20resort%20photography&width=375&height=200&seq=106&orientation=landscape"
              data-badge="">
              예약하기
            </a>
          </div>
        </div>
      </div>
      <div class="text-center py-8">
        <button class="px-6 py-3 bg-gray-100 text-gray-600 rounded-lg cursor-pointer !rounded-button" id="loadMoreBtn">
          더 많은 숙소 보기
        </button>
      </div>
    </div>
    <div id="mapView" class="show">
      <div class="relative h-full">
        <!-- 카카오 지도 컨테이너 -->
        <div id="map" class="w-full h-full bg-gray-100"></div>
        <!-- 지도 상단 지역 정보 -->
        <div class="absolute top-4 left-4 right-4 z-10">
          <div class="bg-white rounded-lg p-3 shadow-sm">
            <div class="flex items-center gap-2 text-sm text-gray-600">
              <i class="ri-map-pin-2-line text-primary"></i>
              <span>경기도 일대 6개 숙소</span>
            </div>
          </div>
        </div>
        <div id="bottomSheet"
          class="fixed bottom-0 left-0 right-0 bg-white rounded-t-xl p-4 shadow-lg transform translate-y-0 transition-transform duration-300 z-50">
          <div class="w-12 h-1 bg-gray-300 rounded-full mx-auto mb-4"></div>
          <div id="bottomSheetList" class="space-y-6 overflow-y-auto" style="max-height: calc(100vh - 260px);">
          </div>
        </div>
        <!-- 숙소 정보 팝업 (지도 컨테이너 안에 위치) -->
        <div id="infoPopup"
          class="hidden absolute w-[280px] h-[200px] bg-white rounded-xl shadow-2xl z-50 border border-gray-100">
          <div class="relative h-[80px]">
            <img id="popupImage" src="" class="w-full h-full object-cover rounded-t-xl" alt="숙소 이미지">
            <button id="closePopup"
              class="absolute top-2 right-2 w-6 h-6 flex items-center justify-center bg-black/50 hover:bg-black/70 rounded-full text-white cursor-pointer transition-colors">
              <i class="ri-close-line text-sm"></i>
            </button>
          </div>
          <div class="p-3 h-[120px] flex flex-col justify-between">
            <div>
              <h3 id="popupTitle" class="font-medium text-sm mb-1 truncate"></h3>
              <div class="flex items-center gap-1 mb-2">
                <i class="ri-star-fill text-yellow-400 text-xs"></i>
                <span id="popupRating" class="text-xs"></span>
                <span class="text-gray-400 text-xs">·</span>
                <span id="popupReviews" class="text-gray-400 text-xs truncate"></span>
              </div>
            </div>
            <div class="flex justify-between items-center">
              <div>
                <p id="popupPrice" class="font-medium text-primary text-sm"></p>
                <p class="text-xs text-gray-500">1박 기준</p>
              </div>
              <button id="popupDetailBtn"
                class="px-3 py-1.5 bg-primary hover:bg-primary/90 text-white rounded-lg text-xs cursor-pointer transition-colors">자세히
                보기</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
  <div id="sideMenu"
    class="fixed top-0 right-0 w-[280px] h-full bg-white transform translate-x-full transition-transform duration-300 z-50 shadow-lg flex flex-col">
    <div class="flex items-center justify-between p-4 border-b">
      <h2 class="text-lg font-medium">메뉴</h2>
      <button id="closeMenu" class="w-8 h-8 flex items-center justify-center">
        <i class="ri-close-line text-xl"></i>
      </button>
    </div>
    <div class="flex-1 overflow-y-auto">
      <div class="p-4 border-b">
        <a href="./login.html" data-readdy="true" class="flex items-center gap-3 py-3 px-4 bg-gray-50 rounded-xl">
          <i class="ri-user-add-line text-xl text-primary"></i>
          <span>로그인/회원가입</span>
        </a>
      </div>
      <div class="p-4 space-y-4">
        <a href="./mypage.html" class="flex items-center gap-3">
          <i class="ri-calendar-check-line text-xl text-gray-600"></i>
          <span>예약 내역</span>
        </a>
        <a href="search.html" class="flex items-center gap-3">
          <i class="ri-search-line text-xl text-gray-600"></i>
          <span>캠핑장 검색</span>
        </a>
        <a href="shop_list.html?type=glamping" class="flex items-center gap-3">
          <i class="ri-home-smile-line text-xl text-gray-600"></i>
          <span>글램핑</span>
        </a>
        <a href="shop_list.html?type=caravan" class="flex items-center gap-3">
          <i class="ri-caravan-line text-xl text-gray-600"></i>
          <span>카라반</span>
        </a>
        <a href="shop_list.html?type=pension" class="flex items-center gap-3">
          <i class="ri-hotel-line text-xl text-gray-600"></i>
          <span>펜션</span>
        </a>
        <a href="shop_list.html?type=hotel" class="flex items-center gap-3">
          <i class="ri-building-line text-xl text-gray-600"></i>
          <span>호텔</span>
        </a>
        <a href="equipment.html" class="flex items-center gap-3">
          <i class="ri-tent-line text-xl text-gray-600"></i>
          <span>캠핑 장비 렌탈</span>
        </a>
        <a href="recomend_course_tmap.html" class="flex items-center gap-3">
          <i class="ri-map-pin-line text-xl text-gray-600"></i>
          <span>T맵 연동 관광 코스</span>
        </a>
        <a href="surroundings.html" class="flex items-center gap-3">
          <i class="ri-restaurant-line text-xl text-gray-600"></i>
          <span>주변 맛집</span>
        </a>
        <a href="event.html" class="flex items-center gap-3">
          <i class="ri-gift-line text-xl text-gray-600"></i>
          <span>이벤트</span>
        </a>
        <a href="customer_service.html" class="flex items-center gap-3">
          <i class="ri-customer-service-line text-xl text-gray-600"></i>
          <span>고객센터</span>
        </a>
      </div>
    </div>
  </div>
  <div id="filterModal" class="fixed inset-0 bg-black/50 z-50 hidden">
    <div class="absolute bottom-0 left-0 right-0 bg-white rounded-t-xl p-4 max-h-[80vh] overflow-y-auto">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-lg font-medium">필터</h2>
        <button class="w-8 h-8 flex items-center justify-center cursor-pointer" id="closeFilterBtn">
          <i class="ri-close-line text-xl"></i>
        </button>
      </div>
      <div class="space-y-6">
        <div>
          <h3 class="font-medium mb-3">가격대</h3>
          <div class="flex items-center gap-4">
            <input type="range" min="5" max="50" value="15"
              class="flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" id="priceRange">
          </div>
          <div class="flex justify-between text-sm text-gray-600 mt-2">
            <span>5만원</span>
            <span id="priceValue">15만원</span>
            <span>50만원</span>
          </div>
        </div>
        <div>
          <h3 class="font-medium mb-3">숙소 유형</h3>
          <div class="grid grid-cols-2 gap-3">
            <label class="flex items-center gap-2 cursor-pointer">
              <input type="checkbox" class="w-4 h-4 text-primary rounded">
              <span class="text-sm">글램핑</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer">
              <input type="checkbox" class="w-4 h-4 text-primary rounded">
              <span class="text-sm">캠핑</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer">
              <input type="checkbox" class="w-4 h-4 text-primary rounded">
              <span class="text-sm">카라반</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer">
              <input type="checkbox" class="w-4 h-4 text-primary rounded">
              <span class="text-sm">펜션</span>
            </label>
          </div>
        </div>
        <div>
          <h3 class="font-medium mb-3">편의시설</h3>
          <div class="grid grid-cols-2 gap-3">
            <label class="flex items-center gap-2 cursor-pointer">
              <input type="checkbox" class="w-4 h-4 text-primary rounded">
              <span class="text-sm">수영장</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer">
              <input type="checkbox" class="w-4 h-4 text-primary rounded">
              <span class="text-sm">바베큐장</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer">
              <input type="checkbox" class="w-4 h-4 text-primary rounded">
              <span class="text-sm">와이파이</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer">
              <input type="checkbox" class="w-4 h-4 text-primary rounded">
              <span class="text-sm">주차장</span>
            </label>
          </div>
        </div>
        <div>
          <h3 class="font-medium mb-3">평점</h3>
          <div class="space-y-2">
            <label class="flex items-center gap-2 cursor-pointer">
              <input type="radio" name="rating" class="w-4 h-4 text-primary">
              <span class="text-sm">4.5점 이상</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer">
              <input type="radio" name="rating" class="w-4 h-4 text-primary">
              <span class="text-sm">4.0점 이상</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer">
              <input type="radio" name="rating" class="w-4 h-4 text-primary">
              <span class="text-sm">3.5점 이상</span>
            </label>
          </div>
        </div>
      </div>
      <div class="flex gap-3 mt-6">
        <button class="flex-1 py-3 bg-gray-100 text-gray-600 rounded-lg cursor-pointer !rounded-button"
          id="resetFilterBtn">
          초기화
        </button>
        <button class="flex-1 py-3 bg-primary text-white rounded-lg cursor-pointer !rounded-button" id="applyFilterBtn">
          적용하기
        </button>
      </div>
    </div>
  </div>
  <nav class="fixed bottom-0 left-0 right-0 bg-white border-t">
    <div class="grid grid-cols-6 py-1">
      <a href="search_map.html?from=nearby" data-readdy="true" class="flex flex-col items-center gap-1 group">
        <div
          class="w-6 h-6 flex items-center justify-center transform transition-transform duration-300 group-hover:scale-110 group-hover:-translate-y-1">
          <i class="ri-map-pin-2-fill text-lg group-hover:text-primary transition-colors duration-300"></i>
        </div>
        <span class="text-[10px] transition-colors duration-300 group-hover:text-primary">내주변</span>
      </a>

      <a href="./index.html" class="flex flex-col items-center gap-1 group">
        <div
          class="w-6 h-6 flex items-center justify-center transform transition-transform duration-300 group-hover:scale-110 group-hover:-translate-y-1">
          <i class="ri-home-5-fill text-lg group-hover:text-primary transition-colors duration-300"></i>
        </div>
        <span class="text-[10px] transition-colors duration-300 group-hover:text-primary">홈</span>
      </a>

      <a href="wishlist.html" data-readdy="true" class="flex flex-col items-center gap-1 group">
        <div
          class="w-6 h-6 flex items-center justify-center transform transition-transform duration-300 group-hover:scale-110 group-hover:-translate-y-1">
          <i class="ri-heart-3-fill text-lg group-hover:text-primary transition-colors duration-300"></i>
        </div>
        <span class="text-[10px] transition-colors duration-300 group-hover:text-primary">찜</span>
      </a>

      <a href="mypage.html" data-readdy="true" class="flex flex-col items-center gap-1 group">
        <div
          class="w-6 h-6 flex items-center justify-center transform transition-transform duration-300 group-hover:scale-110 group-hover:-translate-y-1">
          <i class="ri-user-3-fill text-lg group-hover:text-primary transition-colors duration-300"></i>
        </div>
        <span class="text-[10px] transition-colors duration-300 group-hover:text-primary">마이</span>
      </a>

      <button class="flex flex-col items-center gap-1 group">
        <div
          class="w-6 h-6 flex items-center justify-center transform transition-transform duration-300 group-hover:scale-110 group-hover:-translate-y-1">
          <i class="ri-wallet-3-fill text-lg group-hover:text-primary transition-colors duration-300"></i>
        </div>
        <span class="text-[10px] transition-colors duration-300 group-hover:text-primary">페이</span>
      </button>

      <button id="bottomMenuButton" class="flex flex-col items-center gap-1 group">
        <div
          class="w-6 h-6 flex items-center justify-center transform transition-transform duration-300 group-hover:scale-110 group-hover:-translate-y-1">
          <i class="ri-menu-fill text-lg group-hover:text-primary transition-colors duration-300"></i>
        </div>
        <span class="text-[10px] transition-colors duration-300 group-hover:text-primary">전체</span>
      </button>
    </div>
  </nav>
  <script id="sideMenuScript">
    document.addEventListener('DOMContentLoaded', function () {
      const menuButton = document.getElementById('menuButton');
      const closeMenu = document.getElementById('closeMenu');
      const sideMenu = document.getElementById('sideMenu');

      if (menuButton) {
        menuButton.addEventListener('click', function () {
          sideMenu.classList.remove('translate-x-full');
        });
      }

      if (closeMenu) {
        closeMenu.addEventListener('click', function () {
          sideMenu.classList.add('translate-x-full');
        });
      }

      document.addEventListener('click', function (event) {
        if (sideMenu && menuButton && !sideMenu.contains(event.target) && !menuButton.contains(event.target)) {
          sideMenu.classList.add('translate-x-full');
        }
      });
    });
  </script>
  <script id="viewToggleScript">
    document.addEventListener('DOMContentLoaded', () => {
      const listViewBtn = document.getElementById('listViewBtn');
      const mapViewBtn = document.getElementById('mapViewBtn');
      const listView = document.getElementById('listView');
      const mapView = document.getElementById('mapView');

      listViewBtn.addEventListener('click', () => {
        // 리스트 뷰 활성화
        listView.style.opacity = '1';
        listView.style.zIndex = '20';
        listView.style.pointerEvents = 'auto';
        mapView.style.opacity = '0';
        mapView.style.zIndex = '10';
        mapView.style.pointerEvents = 'none';
        mapView.classList.remove('show');

        // 버튼 스타일 토글
        listViewBtn.classList.add('bg-primary', 'text-white');
        mapViewBtn.classList.remove('bg-primary', 'text-white');
      });

      mapViewBtn.addEventListener('click', () => {
        // 맵 뷰 활성화
        mapView.style.opacity = '1';
        mapView.style.zIndex = '20';
        mapView.style.pointerEvents = 'auto';
        mapView.classList.add('show');
        listView.style.opacity = '0';
        listView.style.zIndex = '10';
        listView.style.pointerEvents = 'none';

        // 버튼 스타일 토글
        mapViewBtn.classList.add('bg-primary', 'text-white');
        listViewBtn.classList.remove('bg-primary', 'text-white');

        // 지도 뷰 활성화 후 하단 카드 드래그 기능 초기화
        setTimeout(() => {
          initBottomCardDrag();
        }, 200);

        // 보인다 싶을 때 리사이즈 & 센터 재설정
        if (typeof kakao !== 'undefined' && kakao.maps && window.map) {
          setTimeout(() => {
            kakao.maps.event.trigger(window.map, 'resize');
            if (window.mapCenter) {
              window.map.setCenter(window.mapCenter);
            }
          }, 100);
        }
      });
    });
  </script>
  <script id="sortScript">
    document.addEventListener('DOMContentLoaded', function () {
      const sortBtn = document.getElementById('sortBtn');
      const sortDropdown = document.getElementById('sortDropdown');
      const sortText = document.getElementById('sortText');
      sortBtn.addEventListener('click', function () {
        sortDropdown.classList.toggle('show');
      });
      document.addEventListener('click', function (e) {
        if (!sortBtn.contains(e.target) && !sortDropdown.contains(e.target)) {
          sortDropdown.classList.remove('show');
        }
      });
      document.querySelectorAll('[data-sort]').forEach(button => {
        button.addEventListener('click', function () {
          const sortType = this.dataset.sort;
          const sortNames = {
            'recommended': '추천순',
            'price': '가격순',
            'rating': '평점순',
            'distance': '거리순'
          };
          sortText.textContent = sortNames[sortType];
          sortDropdown.classList.remove('show');
        });
      });
    });
  </script>
  <script id="wishlistScript">
    // 통일된 위시리스트 토글 기능
    document.addEventListener('click', function (e) {
      if (e.target.closest('.wishlist-btn')) {
        e.preventDefault();
        e.stopPropagation();

        const button = e.target.closest('.wishlist-btn');
        const icon = button.querySelector('i');

        // 토글 애니메이션
        button.style.transform = 'scale(0.8)';

        setTimeout(() => {
          if (icon.classList.contains('ri-heart-line')) {
            // 빈 하트 → 채워진 하트
            icon.classList.remove('ri-heart-line');
            icon.classList.add('ri-heart-fill');
            button.classList.add('active');
            icon.style.color = '#ef4444';
          } else {
            // 채워진 하트 → 빈 하트
            icon.classList.remove('ri-heart-fill');
            icon.classList.add('ri-heart-line');
            button.classList.remove('active');
            icon.style.color = '';
          }

          button.style.transform = 'scale(1)';
        }, 100);
      }
    });

    // 기존 위시리스트 기능 (하위 호환성)
    document.addEventListener('DOMContentLoaded', function () {
      const wishlistBtns = document.querySelectorAll('.wishlist-btn');

      wishlistBtns.forEach(btn => {
        btn.addEventListener('click', function (e) {
          e.preventDefault();
          e.stopPropagation();

          const heartIcon = this.querySelector('i');
          const isWishlisted = heartIcon.classList.contains('ri-heart-fill');

          if (!isWishlisted) {
            heartIcon.classList.remove('ri-heart-line', 'text-gray-600');
            heartIcon.classList.add('ri-heart-fill', 'text-red-500');
          } else {
            heartIcon.classList.add('ri-heart-line', 'text-gray-600');
            heartIcon.classList.remove('ri-heart-fill', 'text-red-500');
          }

        });
      });
    });
  </script>
  <script id="filterScript">
    document.addEventListener('DOMContentLoaded', function () {
      const filterBtn = document.getElementById('filterBtn');
      const filterModal = document.getElementById('filterModal');
      const closeFilterBtn = document.getElementById('closeFilterBtn');
      const resetFilterBtn = document.getElementById('resetFilterBtn');
      const applyFilterBtn = document.getElementById('applyFilterBtn');
      const priceRange = document.getElementById('priceRange');
      const priceValue = document.getElementById('priceValue');
      filterBtn.addEventListener('click', function () {
        filterModal.classList.remove('hidden');
      });
      closeFilterBtn.addEventListener('click', function () {
        filterModal.classList.add('hidden');
      });
      filterModal.addEventListener('click', function (e) {
        if (e.target === filterModal) {
          filterModal.classList.add('hidden');
        }
      });
      priceRange.addEventListener('input', function () {
        priceValue.textContent = this.value + '만원';
      });
      resetFilterBtn.addEventListener('click', function () {
        priceRange.value = 15;
        priceValue.textContent = '15만원';
        document.querySelectorAll('#filterModal input[type="checkbox"]').forEach(checkbox => {
          checkbox.checked = false;
        });
        document.querySelectorAll('#filterModal input[type="radio"]').forEach(radio => {
          radio.checked = false;
        });
      });
      applyFilterBtn.addEventListener('click', function () {
        filterModal.classList.add('hidden');
      });
    });
  </script>
  <script id="loadMoreScript">
    document.addEventListener('DOMContentLoaded', function () {
      const loadMoreBtn = document.getElementById('loadMoreBtn');
      let currentPage = 1;
      loadMoreBtn.addEventListener('click', function () {
        currentPage++;
        this.textContent = '로딩 중...';
        this.disabled = true;
        setTimeout(() => {
          this.textContent = '더 많은 숙소 보기';
          this.disabled = false;
        }, 1000);
      });
    });
  </script>
  <script id="surveyDataScript">
    document.addEventListener('DOMContentLoaded', function () {
      // URL 파라미터에서 설문 데이터 읽기
      const urlParams = new URLSearchParams(window.location.search);
      const people = urlParams.get('people') || '2인';
      const style = urlParams.get('style') || '글램핑';
      const budget = urlParams.get('budget') || 15;
      const regions = urlParams.get('regions') || '경기도';
      const pet = urlParams.get('pet') || 'false';
      const facilities = urlParams.get('facilities') || '';
      const mbti = urlParams.get('mbti') || '';

      // AI 분석 결과 텍스트 업데이트
      const aiResultText = document.querySelector('.px-4.py-2.bg-primary\\/5 p');
      if (aiResultText) {
        // 숙소 개수는 랜덤하게 생성 (실제로는 API에서 받아올 데이터)
        const accommodationCount = Math.floor(Math.random() * 30) + 15; // 15-44개

        // 지역 정보 처리 (첫 번째 지역만 표시)
        const firstRegion = regions.split(',')[0];

        // 반려동물 정보 추가
        const petInfo = pet === 'true' ? ', 반려동물 동반' : '';

        aiResultText.innerHTML = `
          <span class="font-medium text-primary">AI 분석 결과:</span> ${people}, ${style}, ${budget}만원 예산${petInfo}으로 <span class="font-medium">6개</span> 숙소를 찾았어요
        `;
      }

      // 예약하기 버튼 클릭 이벤트 추가
      document.querySelectorAll('.reservation-btn').forEach((btn) => {
        btn.addEventListener('click', function (e) {
          e.preventDefault();
          e.stopPropagation(); // 부모 요소의 클릭 이벤트 방지

          // 예약하기 버튼에서 직접 숙소 정보 읽기
          const title = this.dataset.title || '';
          const region = this.dataset.region || '';
          const price = this.dataset.price || '';
          const rating = this.dataset.rating || '';
          const description = this.dataset.description || '';
          const distance = this.dataset.distance || '';
          const facilities = this.dataset.facilities || '';
          const image = this.dataset.image || '';
          const badge = this.dataset.badge || '';

          // 상세보기 페이지로 이동하면서 숙소 정보와 설문 데이터 전달
          const params = new URLSearchParams();

          // 숙소 정보
          params.append('title', title);
          params.append('region', region);
          params.append('price', price);
          params.append('rating', rating);
          params.append('description', description);
          params.append('distance', distance);
          params.append('facilities', facilities);
          params.append('image', image);
          params.append('badge', badge);

          // 설문 데이터도 함께 전달
          params.append('survey_people', people);
          params.append('survey_style', style);
          params.append('survey_budget', budget);
          params.append('survey_regions', regions);
          params.append('survey_pet', pet);
          params.append('survey_facilities', facilities);
          params.append('survey_mbti', mbti);

          // shop_detail.html로 이동
          window.location.href = `shop_detail.html?${params.toString()}`;
        });
      });
    });
  </script>
  <script id="mapIntegrationScript">
    document.addEventListener('DOMContentLoaded', function () {
      // 1) 전역 변수 및 DOM 참조
      const defaultCoords = { lat: 37.8315, lng: 127.5109 }; // 가평 기본 좌표
      let map = null;
      let userLocation = null;
      let mapMarkers = [];
      const bottomSheet = document.getElementById('bottomSheet');
      const bottomSheetList = document.getElementById('bottomSheetList');

      // 2) 예시 숙소 데이터 (실제론 API 호출해서 받아오시면 됩니다)
      const accommodations = [
        {
          id: 1,
          title: '가평 프리미엄 글램핑',
          type: 'glamping',
          region: '경기도 가평군 청평면 대성리',
          price: '180,000원',
          rating: '4.8',
          reviews: '리뷰 128개',
          description: '자연 속 럭셔리 글램핑 체험 • 반려동물 동반 가능',
          distance: '차량 1시간',
          facilities: '수영장,바베큐장,와이파이',
          image: 'https://readdy.ai/api/search-image?query=Luxury%20glamping%20tent%20with%20panoramic%20windows%20surrounded%20by%20forest%2C%20premium%20camping%20experience%2C%20cozy%20interior%20lighting%2C%20evening%20atmosphere%2C%20professional%20photography%2C%20high-quality%20resort%20accommodation&width=375&height=200&seq=101&orientation=landscape',
          badge: 'AI 추천',
          lat: 37.8315 + (Math.random() - 0.5) * 0.02,
          lng: 127.5109 + (Math.random() - 0.5) * 0.02
        },
        {
          id: 2,
          title: '양평 힐링 글램핑',
          type: 'glamping',
          region: '경기도 양평군 양서면 용담리',
          price: '150,000원',
          rating: '4.6',
          reviews: '리뷰 95개',
          description: '계곡 옆 힐링 글램핑 • 커플 추천',
          distance: '차량 50분',
          facilities: '바베큐장,와이파이,주차장',
          image: 'https://readdy.ai/api/search-image?query=Modern%20glamping%20dome%20with%20mountain%20view%2C%20luxury%20outdoor%20accommodation%2C%20comfortable%20interior%20setup%2C%20sunset%20lighting%2C%20high-quality%20photography%2C%20romantic%20couple-friendly%20atmosphere&width=375&height=200&seq=102&orientation=landscape',
          badge: '인기',
          lat: 37.8315 + (Math.random() - 0.5) * 0.02,
          lng: 127.5109 + (Math.random() - 0.5) * 0.02
        },
        {
          id: 3,
          title: '포천 숲속 글램핑',
          type: 'glamping',
          region: '경기도 포천시 내촌면 금현리',
          price: '160,000원',
          rating: '4.7',
          reviews: '리뷰 156개',
          description: '숲속 프라이빗 글램핑 • 조용한 휴식',
          distance: '차량 1시간 10분',
          facilities: '바베큐장,와이파이',
          image: 'https://readdy.ai/api/search-image?query=Cozy%20glamping%20tent%20with%20private%20deck%2C%20forest%20setting%2C%20romantic%20atmosphere%2C%20warm%20interior%20lighting%2C%20couple-friendly%20accommodation%2C%20premium%20outdoor%20experience&width=375&height=200&seq=103&orientation=landscape',
          badge: '',
          lat: 37.8315 + (Math.random() - 0.5) * 0.02,
          lng: 127.5109 + (Math.random() - 0.5) * 0.02
        },
        {
          id: 4,
          title: '용인 패밀리 글램핑',
          type: 'glamping',
          region: '경기도 용인시 처인구 모현면 능원리',
          price: '140,000원',
          rating: '4.5',
          reviews: '리뷰 89개',
          description: '가족 단위 추천 글램핑 • 다양한 액티비티',
          distance: '차량 40분',
          facilities: '수영장,바베큐장,주차장',
          image: 'https://readdy.ai/api/search-image?query=Luxury%20glamping%20village%20with%20multiple%20tents%2C%20family-friendly%20outdoor%20resort%2C%20beautiful%20landscape%20setting%2C%20professional%20hospitality%20photography%2C%20premium%20camping%20facilities&width=375&height=200&seq=104&orientation=landscape',
          badge: '',
          lat: 37.8315 + (Math.random() - 0.5) * 0.02,
          lng: 127.5109 + (Math.random() - 0.5) * 0.02
        },
        {
          id: 5,
          title: '남양주 리버사이드 글램핑',
          type: 'glamping',
          region: '경기도 남양주시 와부읍 도곡리',
          price: '135,000원',
          rating: '4.4',
          reviews: '리뷰 112개',
          description: '강변 뷰 글램핑 • 수상 액티비티 가능',
          distance: '차량 45분',
          facilities: '바베큐장,와이파이',
          image: 'https://readdy.ai/api/search-image?query=Riverside%20glamping%20tents%20with%20water%20view%2C%20peaceful%20natural%20setting%2C%20luxury%20camping%20experience%2C%20serene%20atmosphere%2C%20high-quality%20outdoor%20accommodation%20photography&width=375&height=200&seq=105&orientation=landscape',
          badge: '',
          lat: 37.8315 + (Math.random() - 0.5) * 0.02,
          lng: 127.5109 + (Math.random() - 0.5) * 0.02
        },
        {
          id: 6,
          title: '이천 마운틴뷰 글램핑',
          type: 'glamping',
          region: '경기도 이천시 마장면 목리',
          price: '170,000원',
          rating: '4.6',
          reviews: '리뷰 78개',
          description: '산 전망 글램핑 • 일출 명소',
          distance: '차량 1시간 20분',
          facilities: '바베큐장,주차장',
          image: 'https://readdy.ai/api/search-image?query=Mountain%20view%20glamping%20resort%20with%20panoramic%20scenery%2C%20premium%20outdoor%20accommodation%2C%20luxury%20camping%20facilities%2C%20beautiful%20natural%20landscape%2C%20professional%20resort%20photography&width=375&height=200&seq=106&orientation=landscape',
          badge: '',
          lat: 37.8315 + (Math.random() - 0.5) * 0.02,
          lng: 127.5109 + (Math.random() - 0.5) * 0.02
        }
      ];

      // 3) 사용자 위치 획득
      async function getUserLocation() {
        return new Promise((resolve, reject) => {
          if (!navigator.geolocation) {
            return reject(new Error('브라우저가 위치 정보를 지원하지 않습니다.'));
          }
          navigator.geolocation.getCurrentPosition(
            pos => resolve({ lat: pos.coords.latitude, lng: pos.coords.longitude }),
            err => reject(err),
            { enableHighAccuracy: true, timeout: 10000, maximumAge: 60000 }
          );
        });
      }

      // 4) URL 파라미터로 'nearby' 접근 여부 판단
      function isLocationBasedAccess() {
        return new URLSearchParams(window.location.search).get('from') === 'nearby';
      }

      // 5) (선택) 위치 기반 알림 UI
      function showLocationNotification(message, type = 'info') {
        // TODO: toast 등으로 표시
        console.log(`[위치알림:${type}] ${message}`);
      }

      // 6) 사용자 주변 마커 재배치 (겹침 방지)
      function relocateAccommodationsNearUser(userLat, userLng) {
        const latRange = 0.02, lngRange = 0.02;
        const used = [];
        accommodations.forEach((acc, i) => {
          let newLat, newLng, tries = 0, ok = false;
          while (tries < 10 && !ok) {
            tries++;
            newLat = userLat + (Math.random() - 0.5) * latRange;
            newLng = userLng + (Math.random() - 0.5) * lngRange;
            ok = !used.some(p => Math.abs(p.lat - newLat) < 0.005 && Math.abs(p.lng - newLng) < 0.005);
          }
          if (!ok) {
            const angle = (i / accommodations.length) * Math.PI * 2;
            const d = Math.min(latRange, lngRange) * 0.6;
            newLat = userLat + Math.cos(angle) * d;
            newLng = userLng + Math.sin(angle) * d;
          }
          acc.lat = newLat; acc.lng = newLng;
          used.push({ lat: newLat, lng: newLng });
        });
      }

      // 7) 바텀시트 리스트 렌더링
      function renderBottomSheetList() {
        bottomSheetList.innerHTML = '';
        accommodations.forEach(acc => {
          const card = document.createElement('div');
          card.className = 'flex items-center gap-3 cursor-pointer';
          card.innerHTML = `
        <img src="${acc.image}" class="w-16 h-16 rounded-lg object-cover" alt="${acc.title}">
        <div class="flex-1">
          <h3 class="font-medium">${acc.title}</h3>
          <p class="text-sm text-gray-600">${acc.region}</p>
          <div class="flex items-center gap-2 mt-1">
            <div class="flex items-center gap-1">
              <i class="ri-star-fill text-yellow-400 text-xs"></i>
              <span class="text-xs">${acc.rating}</span>
            </div>
            <span class="text-sm font-medium text-primary">${acc.price}</span>
          </div>
        </div>
        <button class="px-4 py-2 bg-primary text-white rounded-lg text-sm font-medium cursor-pointer !rounded-button detail-btn"
          data-accommodation='${JSON.stringify(acc)}'>
          상세보기
        </button>
      `;
          // 카드 클릭 시 바텀시트 펼치기
          card.addEventListener('click', () => {
            showBottomSheet();
          });

          // 상세보기 버튼 클릭 이벤트
          const detailBtn = card.querySelector('.detail-btn');
          detailBtn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();

            // 숙소 정보를 URL 파라미터로 전달
            const params = new URLSearchParams();

            // 기본 숙소 정보
            params.append('title', acc.title);
            params.append('region', acc.region);
            params.append('price', acc.price.replace(/[₩,원]/g, ''));
            params.append('rating', acc.rating);
            params.append('description', acc.description);
            params.append('distance', acc.distance);
            params.append('facilities', acc.facilities);
            params.append('image', acc.image);
            params.append('badge', acc.badge);
            params.append('type', acc.type);

            // 설문 데이터도 함께 전달 (URL에서 가져온 데이터)
            const urlParams = new URLSearchParams(window.location.search);
            const surveyData = {
              'survey_people': urlParams.get('people') || '2인',
              'survey_style': urlParams.get('style') || '글램핑',
              'survey_budget': urlParams.get('budget') || '15',
              'survey_regions': urlParams.get('regions') || '경기도',
              'survey_pet': urlParams.get('pet') || 'false',
              'survey_facilities': urlParams.get('facilities') || '',
              'survey_mbti': urlParams.get('mbti') || ''
            };

            // 설문 데이터 추가
            Object.entries(surveyData).forEach(([key, value]) => {
              if (value) {
                params.append(key, value);
              }
            });

            // shop_detail.html로 이동
            window.location.href = `shop_detail.html?${params.toString()}`;
          });

          bottomSheetList.appendChild(card);
        });
      }

      // 8) 바텀시트 드래그/스와이프 제어
      let startY = 0;
      function initBottomCardDrag() {
        bottomSheet.addEventListener('touchstart', e => { startY = e.touches[0].clientY; });
        bottomSheet.addEventListener('touchmove', e => {
          e.preventDefault();      // <- 페이지 스크롤 방지
          e.stopPropagation();     // <- 상위 요소로의 터치 전파 차단
          const delta = e.touches[0].clientY - startY;
          if (delta > 0) bottomSheet.style.transform = `translateY(${delta}px)`;
        }, { passive: false });
        bottomSheet.addEventListener('touchend', e => {
          const delta = e.changedTouches[0].clientY - startY;
          delta > 100 ? hideBottomSheet() : showBottomSheet();
        });
      }
      function showBottomSheet() {
        bottomSheet.style.transition = 'transform 0.3s ease-out';
        bottomSheet.style.transform = 'translateY(0)';
      }
      function hideBottomSheet() {
        bottomSheet.style.transition = 'transform 0.3s ease-out';
        bottomSheet.style.transform = 'translateY(80%)';
      }

      // 8-1) 숙소 정보 팝업 표시
      function showAccommodationPopup(accommodation, clickPosition) {
        const popup = document.getElementById('infoPopup');
        const popupImage = document.getElementById('popupImage');
        const popupTitle = document.getElementById('popupTitle');
        const popupRating = document.getElementById('popupRating');
        const popupReviews = document.getElementById('popupReviews');
        const popupPrice = document.getElementById('popupPrice');
        const popupDetailBtn = document.getElementById('popupDetailBtn');

        if (!popup) {
          return;
        }

        try {
          if (popupImage) {
            popupImage.src = accommodation.image;
          }

          if (popupTitle) {
            popupTitle.textContent = accommodation.title;
          }

          if (popupRating) {
            popupRating.textContent = accommodation.rating;
          }

          if (popupReviews) {
            popupReviews.textContent = accommodation.reviews;
          }

          if (popupPrice) {
            popupPrice.textContent = accommodation.price;
          }

          // 상세보기 버튼 이벤트
          if (popupDetailBtn) {
            popupDetailBtn.onclick = function () {
              // shop_detail.html로 이동 (숙소 정보 전달)
              const params = new URLSearchParams();
              params.append('title', accommodation.title);
              params.append('price', accommodation.price.replace(/[₩,]/g, ''));
              params.append('rating', accommodation.rating);
              params.append('image', accommodation.image);
              params.append('type', accommodation.type);
              params.append('region', accommodation.region);

              window.location.href = `shop_detail.html?${params.toString()}`;
            };
          }

          // 팝업 위치 계산 - 클릭 위치를 최우선으로 사용
          const mapContainer = document.getElementById('map');

          // 팝업 크기 (고정)
          const popupWidth = 280;
          const popupHeight = 200;

          let popupX, popupY;

          // 클릭 위치가 전달된 경우 이를 직접 사용 (지도 컨테이너 기준)
          if (clickPosition) {
            // 클릭 위치 기준으로 팝업 배치
            popupX = clickPosition.x + 15; // 클릭 위치에서 15px 오른쪽
            popupY = clickPosition.y - (popupHeight / 2); // 클릭 위치를 팝업 중앙에 맞춤

            // 지도 컨테이너 경계 체크 및 조정
            const mapWidth = mapContainer.offsetWidth;
            const mapHeight = mapContainer.offsetHeight;

            // 오른쪽 경계 체크
            if (popupX + popupWidth > mapWidth) {
              popupX = clickPosition.x - popupWidth - 15; // 클릭 위치 왼쪽에 배치
            }

            // 위쪽 경계 체크
            if (popupY < 0) {
              popupY = 10;
            }

            // 아래쪽 경계 체크
            if (popupY + popupHeight > mapHeight) {
              popupY = mapHeight - popupHeight - 10;
            }

            // 왼쪽 경계 체크 (팝업이 왼쪽으로 이동했을 때)
            if (popupX < 0) {
              popupX = 10;
              popupY = clickPosition.y + 15; // 클릭 위치 아래쪽에 배치

              // 아래쪽으로 이동 후 다시 경계 체크
              if (popupY + popupHeight > mapHeight) {
                popupY = clickPosition.y - popupHeight - 15; // 클릭 위치 위쪽에 배치
              }
            }

          } else {
            // 클릭 위치가 없는 경우 지도 중앙에 배치
            popupX = (mapContainer.offsetWidth - popupWidth) / 2;
            popupY = (mapContainer.offsetHeight - popupHeight) / 2;
          }

          if (clickPosition) {
            const distanceX = Math.abs(popupX - clickPosition.x);
            const distanceY = Math.abs(popupY + popupHeight / 2 - clickPosition.y);
          }

          // 팝업 위치 설정 (지도 컨테이너 기준 절대 위치)
          popup.style.left = `${popupX}px`;
          popup.style.top = `${popupY}px`;
          popup.style.position = 'absolute';

          // 팝업 표시
          popup.classList.remove('hidden');

          // 표시 확인
          setTimeout(() => {
            const isVisible = !popup.classList.contains('hidden');

            if (isVisible) {
              const computedStyle = window.getComputedStyle(popup);
            }
          }, 50);

        } catch (error) {
          return
        }
      }

      // 8-2) 숙소 정보 팝업 숨기기
      function hideAccommodationPopup() {
        const popup = document.getElementById('accommodationPopup');
        const overlay = document.getElementById('popupOverlay');
        if (popup) popup.remove();
        if (overlay) overlay.remove();
      }

      // 9) 지도 초기화
      async function initMap() {
        const container = document.getElementById('map');
        let centerLat = defaultCoords.lat, centerLng = defaultCoords.lng, level = 5;

        if (isLocationBasedAccess()) {
          try {
            userLocation = await getUserLocation();
            centerLat = userLocation.lat; centerLng = userLocation.lng; level = 4;
            showLocationNotification('현재 위치 기반으로 주변 숙소를 찾습니다.');
          } catch {
            showLocationNotification('위치 정보를 가져올 수 없어 기본 지역으로 설정합니다.', 'warning');
          }
        }

        map = new kakao.maps.Map(container, {
          center: new kakao.maps.LatLng(centerLat, centerLng),
          level
        });
        window.map = map; window.mapCenter = new kakao.maps.LatLng(centerLat, centerLng);

        if (userLocation) {
          const overlay = new kakao.maps.CustomOverlay({
            position: new kakao.maps.LatLng(userLocation.lat, userLocation.lng),
            content: `<div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center shadow-lg">
                      <i class="ri-user-location-fill text-white text-sm"></i>
                    </div>`,
            yAnchor: 0.5, zIndex: 200
          });
          overlay.setMap(map);
        }

        setTimeout(() => {
          if (userLocation) relocateAccommodationsNearUser(userLocation.lat, userLocation.lng);
          createMarkers();
        }, 800);
      }

      // 10) 마커 생성
      function createMarkers() {
        // 기존에 찍혀 있는 마커들을 모두 지우고 배열 초기화
        mapMarkers.forEach(m => { try { m.setMap(null); } catch { } });
        mapMarkers = [];

        accommodations.forEach((acc, index) => {
          // 1) 커스텀 마커 HTML
          const markerContent = `
        <div class="relative marker-${index}" data-accommodation-id="${acc.id}">
          <div class="w-[100px] h-[36px] flex items-center justify-center
                      bg-primary text-white rounded-full shadow-lg
                      hover:shadow-xl transition-all duration-300
                      transform hover:scale-110 cursor-pointer marker-clickable">
            <span class="text-sm font-medium">₩${acc.price}</span>
          </div>
        </div>
      `;

          // 2) Kakao CustomOverlay 생성
          const overlay = new kakao.maps.CustomOverlay({
            position: new kakao.maps.LatLng(acc.lat, acc.lng),
            content: markerContent,
            yAnchor: 0.5,
            zIndex: 100 + index
          });

          // 3) 지도에 추가
          overlay.setMap(map);
          mapMarkers.push(overlay);

          // 4) 클릭 이벤트 바인딩 (잠시 딜레이를 줘야 DOM이 렌더링됩니다)
          setTimeout(() => {
            const el = document.querySelector(`.marker-${index} .marker-clickable`);
            if (!el) return;
            // 중복 리스너 방지
            el.replaceWith(el.cloneNode(true));
            const clickable = document.querySelector(`.marker-${index} .marker-clickable`);
            clickable.addEventListener('click', (event) => {
              // 이벤트 버블링 방지
              event.stopPropagation();
              event.preventDefault();

              // 다른 팝업이 열려있으면 먼저 닫기
              const existingPopup = document.getElementById('infoPopup');
              if (existingPopup && !existingPopup.classList.contains('hidden')) {
                existingPopup.classList.add('hidden');
              }

              // 실제 클릭한 화면 좌표 사용 (가장 정확한 방법)
              const mapContainer = document.getElementById('map');
              const mapRect = mapContainer.getBoundingClientRect();

              // 클릭한 화면 좌표를 지도 컨테이너 기준 상대 좌표로 변환
              const clickPosition = {
                x: event.clientX - mapRect.left,
                y: event.clientY - mapRect.top
              };

              // 숙소 정보와 함께 클릭 위치도 전달
              showAccommodationPopup(acc, clickPosition);
            });
          }, 100);
        });
      }

      // 11) 맵 API 로드 후 실행
      if (typeof kakao !== 'undefined' && kakao.maps) {
        initMap().then(() => {
          renderBottomSheetList();
          initBottomCardDrag();
          hideBottomSheet(); // 시작 시 숨김
        });
      } else {
        // 카카오 맵 로드 실패 시 대체 UI
        const mapContainer = document.getElementById('map');
        mapContainer.innerHTML = `
        <div class="w-full h-full flex items-center justify-center bg-gray-100 text-gray-500 rounded-xl">
          <i class="ri-map-2-line text-4xl mb-2"></i>
          <p>지도를 불러올 수 없습니다</p>
          <p class="text-sm">잠시 후 다시 시도해주세요</p>
        </div>`;
      }
    });
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const mapView = document.getElementById('mapView');
      const mapBtn = document.getElementById('mapViewBtn');
      const listBtn = document.getElementById('listViewBtn');
      const listView = document.getElementById('listView');

      mapView.classList.add('show');
      mapBtn.classList.add('bg-primary', 'text-white');
      listBtn.classList.remove('bg-primary', 'text-white');

      listView.style.opacity = '0';
      listView.style.pointerEvents = 'none';

      setTimeout(() => {
        if (window.map && kakao && kakao.maps) {
          kakao.maps.event.trigger(window.map, 'resize');
          window.map.setCenter(window.mapCenter);
        }
      }, 200);
    });
  </script>
  <script>
    // 팝업 닫기 기능
    function hideInfoPopup() {
      const popup = document.getElementById('infoPopup');
      if (popup) {
        popup.classList.add('hidden');
      }
    }

    // 팝업 닫기 버튼 이벤트
    document.addEventListener('DOMContentLoaded', function () {
      const closePopup = document.getElementById('closePopup');
      if (closePopup) {
        closePopup.addEventListener('click', function () {
          const popup = document.getElementById('infoPopup');
          popup.classList.add('hidden');
        });
      }

      // 팝업 외부 클릭 시 닫기
      const infoPopup = document.getElementById('infoPopup');
      if (infoPopup) {
        infoPopup.addEventListener('click', function (e) {
          if (e.target === this) {
            this.classList.add('hidden');
          }
        });
      }

      // 지도 클릭 시 팝업 닫기
      if (map) {
        kakao.maps.event.addListener(map, 'click', function () {
          const popup = document.getElementById('infoPopup');
          if (!popup.classList.contains('hidden')) {
            popup.classList.add('hidden');
          }
        });
      }
    });
  </script>
</body>

</html>